version: 1
binary: ../target/release/ralpher

sandbox:
  workdir: temp
  inherit_env: true

tests:
  - name: "validate with failing validator"
    setup:
      - write_file:
          path: "ralpher.toml"
          contents: |
            validators = ["false"]
    steps:
      - name: run
        run:
          cmd: "sh"
          args: ["-c", "RUST_LOG=info ${BINARY} validate 2>&1"]
        expect:
          exit: 1
          stdout:
            contains: "Some validators failed"
