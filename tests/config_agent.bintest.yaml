version: 1
binary: ../target/release/ralpher

sandbox:
  workdir: temp
  inherit_env: true

tests:
  - name: "config with agent section - status works"
    setup:
      - write_file:
          path: "ralpher.toml"
          contents: |
            git_mode = "branch"

            [agent]
            type = "command"
            cmd = ["echo", "hello"]
    steps:
      - name: run
        run:
          cmd: "sh"
          args: ["-c", "RUST_LOG=info ${BINARY} status 2>&1"]
        expect:
          exit: 0
          stdout:
            contains: "no active run"
